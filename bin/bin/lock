#!/usr/bin/env bash

pause () {
  notify-send "DUNST_COMMAND_PAUSE"
  spotifyctl stop 2> /dev/null
}

resume () {
  #spotifyctl playpause 2> /dev/null
  notify-send "DUNST_COMMAND_RESUME"
}

pause

# Corrupted version of wallpaper only
# NOTE: Requires corrupter binary and imagemagick for png conversion
if [ -e ~/.wallpaper ]; then
  if ! md5sum -c ~/.cache/wallpaper.md5 || [ ! -e ~/.cache/wallpaper-corrupted.png ]; then
    md5sum ~/.wallpaper > ~/.cache/wallpaper.md5
    convert $(realpath ~/.wallpaper) ~/.cache/wallpaper-corrupted.png
    corrupter -mag 3 -boffset 20 -bheight 7  ~/.cache/wallpaper-corrupted.png ~/.cache/wallpaper-corrupted.png
  fi
fi

i3lock -c 000000 -t -i ~/.cache/wallpaper-corrupted.png -n; resume
